<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工业热泵经济与环境效益分析器 V13.0 (试用版)</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    
  <script type="module" crossorigin src="/heat-pump-analyzer-pro/assets/index-DkYui2uE.js"></script>
  <link rel="stylesheet" crossorigin href="/heat-pump-analyzer-pro/assets/index-CLZ2PIZw.css">
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <!-- 全局通知 -->
    <div id="global-notifier" class="hidden fixed top-5 right-5 z-50 max-w-sm p-4 rounded-lg shadow-lg" role="alert">
        <div class="flex items-center">
            <svg class="w-6 h-6 mr-3" id="global-notifier-icon-success" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
            <svg class="w-6 h-6 mr-3 hidden" id="global-notifier-icon-error" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>
            <span id="global-notifier-text" class="text-sm font-medium">通知内容</span>
        </div>
    </div>

    <!-- 主应用容器 -->
    <div class="container mx-auto p-4 md:p-8 max-w-6xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">工业热泵经济与环境效益分析器 <span class="text-lg font-normal text-blue-600">V13.0 (试用版)</span></h1>
            <p class="mt-2 text-md text-gray-600">综合评估工业热泵(含储能)相较于传统锅炉的投资回报、全寿命周期成本(LCC)与环保优势</p>
            <p class="mt-1 text-sm text-gray-500">发布时间: 2025年11月18日</p>
        </header>

        <main class="space-y-8">
            
            <!-- 1. 项目基本信息 -->
            <section class="bg-white p-6 rounded-xl shadow-md">
                <h2 class="text-xl font-semibold mb-6 border-l-4 border-blue-500 pl-4">1. 项目基本信息</h2>
                
                <div>
                    <label for="projectName" class="block text-sm font-medium text-gray-700">项目名称</label>
                    <input type="text" id="projectName" value="示例项目" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                </div>

                <div class="mt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">年加热量计算模式</label>
                    <fieldset class="flex flex-col sm:flex-row sm:items-center gap-y-3 sm:gap-x-6">
                        <div class="flex items-center">
                            <input type="radio" id="calcModeAnnualHours" name="calcMode" value="annual" class="h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-500 track-change" checked>
                            <label for="calcModeAnnualHours" class="ml-2 text-sm font-medium text-gray-700">模式A: 按年总小时计算</label>
                        </div>
                        <div class="flex items-center">
                            <input type="radio" id="calcModeTotalHeat" name="calcMode" value="total" class="h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-500 track-change">
                            <label for="calcModeTotalHeat" class="ml-2 text-sm font-medium text-gray-700">模式B: 按年总热量计算</label>
                        </div>
                        <div class="flex items-center">
                            <input type="radio" id="calcModeDailyLoad" name="calcMode" value="daily" class="h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-500 track-change">
                            <label for="calcModeDailyLoad" class="ml-2 text-sm font-medium text-gray-700">模式C: 按天数与负荷率计算</label>
                        </div>
                    </fieldset>
                </div>
                
                <div id="calcModeAContainer" class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="heatingLoadUnit" class="block text-sm font-medium text-gray-700">制热负荷</label>
                        <select id="heatingLoadUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <option value="kW" selected>kW (千瓦)</option>
                            <option value="kcal/h">kcal/h (大卡/小时)</option>
                        </select>
                        <input type="number" id="heatingLoad" data-base-value="1000" value="1000" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                    </div>
                    <div>
                        <label for="operatingHours" class="block text-sm font-medium text-gray-700">年运行小时 (h/年)</label>
                        <input type="number" id="operatingHours" value="2000" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                    </div>
                </div>

                <div id="calcModeBContainer" class="mt-6 hidden">
                    <div>
                        <label for="annualHeatingUnit" class="block text-sm font-medium text-gray-700">年总加热量</label>
                        <select id="annualHeatingUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <option value="kWh" selected>kWh (千瓦时)</option>
                            <option value="KJ">KJ (千焦)</option>
                            <option value="MJ">MJ (兆焦)</option>
                            <option value="GJ">GJ (吉焦)</option>
                            <option value="TJ">TJ (太焦)</option>
                            <option value="万大卡">万大卡</option>
                            <option value="Mkcal">Mkcal (兆大卡)</option>
                        </select>
                        <input type="number" id="annualHeating" data-base-value="2000000" value="2000000" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change default-param">
                    </div>
                </div>

                <div id="calcModeCContainer" class="mt-6 hidden grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <label for="dailyHours" class="block text-sm font-medium text-gray-700">每天运行小时数 (h/day)</label>
                        <input type="number" id="dailyHours" value="8" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change default-param">
                    </div>
                    <div>
                        <label for="annualDays" class="block text-sm font-medium text-gray-700">全年运行天数 (days/year)</label>
                        <input type="number" id="annualDays" value="300" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change default-param">
                    </div>
                    <div>
                        <label for="loadFactor" class="block text-sm font-medium text-gray-700">平均负荷率 (%)</label>
                        <input type="number" id="loadFactor" value="70" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change default-param">
                    </div>
                </div>
            </section>

            <!-- 2. 方案配置 -->
            <section class="bg-white p-6 rounded-xl shadow-md">
                <h2 id="section2Title" class="text-xl font-semibold mb-6 border-l-4 border-blue-500 pl-4">2. 方案配置</h2>
                
                <div class="mb-6 pb-6 border-b">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">方案 A (您的方案) 配置</h3>
                    <fieldset class="flex flex-col space-y-4">
                        <div class="flex items-center">
                            <input type="radio" id="modeStandard" name="schemeAMode" value="standard" class="h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-500 track-change" checked>
                            <label for="modeStandard" class="ml-3 text-sm font-medium text-gray-700">模式一: 100% 工业热泵 (成本对比)</label>
                        </div>
                        <div class="flex items-center">
                            <input type="radio" id="modeHybrid" name="schemeAMode" value="hybrid" class="h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-500 track-change">
                            <label for="modeHybrid" class="ml-3 text-sm font-medium text-gray-700">模式二: 混合系统 (成本对比)</label>
                        </div>
                        <div class="flex items-start">
                            <input type="radio" id="modeBot" name="schemeAMode" value="bot" class="h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-500 track-change mt-1">
                            <div class="ml-3 tooltip-container">
                                <label for="modeBot" class="text-sm font-medium text-gray-700">
                                    模式三: BOT / EMC (升级中)
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                </label>
                                <div class="tooltip-text text-left">
                                    <b>BOT (建设-运营-移交):</b> 投资者出资建设，在合同期内运营并收费（卖热），期满后将项目移交给客户。<br><br>
                                    <b>EMC (合同能源管理):</b> 能源服务公司为项目提供资金和技术，通过分享项目产生的“节能效益”来获利。
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div>
                        <label for="hpCapex" class="block text-sm font-medium text-gray-700 tooltip-container">
                            工业热泵主机投资 (万元)
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            <span class="tooltip-text"><b>说明:</b><br>指工业热泵主机、水泵、管网及其他配套设施的投资。<b>不应</b>包含储能系统（请填入下方专用栏）。</span>
                        </label>
                        <input type="number" id="hpCapex" value="200" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                    </div>
                    <div>
                        <label for="storageCapex" class="block text-sm font-medium text-gray-700">储能系统投资 (万元)</label>
                        <input type="number" id="storageCapex" value="0" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                    </div>
                    <div>
                        <label for="hpSalvageRate" class="block text-sm font-medium text-gray-700">残值率 (%)</label>
                        <input type="number" id="hpSalvageRate" value="5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                    </div>
                </div>

                <div id="hybridConfigInputs" class="hidden mt-6 pt-6 border-t border-dashed border-blue-300">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div>
                            <label for="hybridLoadShare" class="block text-sm font-medium text-gray-700 tooltip-container">
                                工业热泵承担的负荷比例 (%)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>示例:</b><br>总加热-30℃ -> 150℃ (总温升180℃)<br>工业热泵加热-30℃ -> 50℃ (温升80℃)<br>应填写: (80 / 180) * 100 = 44.4%</span>
                            </label>
                            <input type="number" id="hybridLoadShare" value="50" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                        </div>
                        <div>
                            <label for="hybridAuxHeaterType" class="block text-sm font-medium text-gray-700">选择辅助热源</label>
                            <select id="hybridAuxHeaterType" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="electric" selected>电加热器/电锅炉</option>
                                <option value="gas">天然气锅炉</option>
                                <option value="fuel">燃油锅炉</option>
                                <option value="coal">燃煤锅炉</option>
                                <option value="biomass">生物质锅炉</option>
                                <option value="steam">管网蒸汽</option>
                            </select>
                        </div>
                        <div>
                            <label for="hybridAuxHeaterCapex" class="block text-sm font-medium text-gray-700">辅助热源初始投资 (万元)</label>
                            <input type="number" id="hybridAuxHeaterCapex" value="30" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                        </div>
                        <div>
                            <label for="hybridAuxHeaterOpex" class="block text-sm font-medium text-gray-700">辅助热源运维成本 (万元/年)</label>
                            <input type="number" id="hybridAuxHeaterOpex" value="0.5" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                        </div>
                    </div>
                </div>

                <div id="botConfigInputs" class="hidden mt-6 pt-6 border-t border-dashed border-green-300">
                    <h3 class="text-lg font-semibold text-green-800 mb-4 col-span-full">模式三: BOT / EMC 专属参数</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div>
                            <label for="botAnnualRevenue" class="block text-sm font-medium text-gray-700 tooltip-container">
                                年销售收入 (万元)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>这是 BOT 模式的“命根子”</b>。<br><br>这是我们和客户谈好的“每年卖热的总价钱”。这个数字的合理性，直接决定了我们（投资者）的利润。</span>
                            </label>
                            <input type="number" id="botAnnualRevenue" value="150" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botAnnualEnergyCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                年能源成本 (万元)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>这是BOT项目的主要支出。</b><br><br>请预估项目第1年的总能源成本（如电费、燃气费等）。计算器将基于此值，并结合“能源价格涨幅”来推算未来成本。</span>
                            </label>
                            <input type="number" id="botAnnualEnergyCost" value="60" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botAnnualOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                年运维成本 (万元)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>这是BOT项目的固定支出。</b><br><br>请预估项目第1年的总运维、人工、维保物料成本。计算器将基于此值，并结合“运维成本涨幅”来推算未来成本。</span>
                            </label>
                            <input type="number" id="botAnnualOpexCost" value="5" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botEquityRatio" class="block text-sm font-medium text-gray-700 tooltip-container">
                                资本金比例 (%)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>我们自己掏多少钱？</b><br><br>假设总投资200万，您填30%，意思就是我们自己掏 60万，剩下 140万 找银行贷款。这个比例会极大影响“资本金收益率 (EIRR)”。</span>
                            </label>
                            <input type="number" id="botEquityRatio" value="30" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botLoanInterestRate" class="block text-sm font-medium text-gray-700 tooltip-container">
                                贷款利率 (%)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>默认值: 5 %</b><br>我们(投资者)向银行贷款的年化利率。</span>
                            </label>
                            <input type="number" id="botLoanInterestRate" value="5" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botDepreciationYears" class="block text-sm font-medium text-gray-700 tooltip-container">
                                折旧年限 (年)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>会计做账用的“成本分摊”</b>。<br><br>它<b>不是</b>我们真正掏出去的钱，但它在账面上可以“抵扣利润”，从而帮我们<b>少交所得税</b>。</span>
                            </label>
                            <input type="number" id="botDepreciationYears" value="10" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botVatRate" class="block text-sm font-medium text-gray-700">增值税率 (%)</label>
                            <input type="number" id="botVatRate" value="13" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botSurtaxRate" class="block text-sm font-medium text-gray-700">附加税费率 (%)</label>
                            <input type="number" id="botSurtaxRate" value="12" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                        <div>
                            <label for="botIncomeTaxRate" class="block text-sm font-medium text-gray-700">所得税率 (%)</label>
                            <input type="number" id="botIncomeTaxRate" value="25" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 track-change default-param">
                        </div>
                     </div>
                </div>

                <div id="comparisonTogglesContainer" class="mt-6 pt-6 border-t">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">方案 B (对比基准): 100% 传统热源投资 (请勾选)</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-x-6 gap-y-8">
                        <div class="related-to-gas">
                            <div class="flex items-center mb-2">
                                <input type="checkbox" id="compare_gas" data-target="gas" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 comparison-toggle track-change" checked>
                                <label for="compare_gas" class="ml-2 block text-sm font-medium text-gray-700">天然气锅炉</label>
                            </div>
                            <label for="gasBoilerCapex" class="block text-sm font-medium text-gray-600 mt-2">投资 (万元)</label>
                            <input type="number" id="gasBoilerCapex" value="80" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <label for="gasSalvageRate" class="block text-xs font-medium text-gray-600 mt-2">残值率 (%)</label>
                            <input type="number" id="gasSalvageRate" value="5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-fuel">
                            <div class="flex items-center mb-2">
                                <input type="checkbox" id="compare_fuel" data-target="fuel" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 comparison-toggle track-change" checked>
                                <label for="compare_fuel" class="ml-2 block text-sm font-medium text-gray-700">燃油锅炉</label>
                            </div>
                            <label for="fuelBoilerCapex" class="block text-sm font-medium text-gray-600 mt-2">投资 (万元)</label>
                            <input type="number" id="fuelBoilerCapex" value="70" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <label for="fuelSalvageRate" class="block text-xs font-medium text-gray-600 mt-2">残值率 (%)</label>
                            <input type="number" id="fuelSalvageRate" value="5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-coal">
                            <div class="flex items-center mb-2">
                                <input type="checkbox" id="compare_coal" data-target="coal" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 comparison-toggle track-change" checked>
                                <label for="compare_coal" class="ml-2 block text-sm font-medium text-gray-700">燃煤锅炉</label>
                            </div>
                            <label for="coalBoilerCapex" class="block text-sm font-medium text-gray-600 mt-2">投资 (万元)</label>
                            <input type="number" id="coalBoilerCapex" value="60" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <label for="coalSalvageRate" class="block text-xs font-medium text-gray-600 mt-2">残值率 (%)</label>
                            <input type="number" id="coalSalvageRate" value="5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-biomass">
                            <div class="flex items-center mb-2">
                                <input type="checkbox" id="compare_biomass" data-target="biomass" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 comparison-toggle track-change" checked>
                                <label for="compare_biomass" class="ml-2 block text-sm font-medium text-gray-700">生物质锅炉</label>
                            </div>
                            <label for="biomassBoilerCapex" class="block text-sm font-medium text-gray-600 mt-2">投资 (万元)</label>
                            <input type="number" id="biomassBoilerCapex" value="75" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <label for="biomassSalvageRate" class="block text-xs font-medium text-gray-600 mt-2">残值率 (%)</label>
                            <input type="number" id="biomassSalvageRate" value="5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-electric">
                            <div class="flex items-center mb-2">
                                <input type="checkbox" id="compare_electric" data-target="electric" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 comparison-toggle track-change" checked>
                                <label for="compare_electric" class="ml-2 block text-sm font-medium text-gray-700">电锅炉</label>
                            </div>
                            <label for="electricBoilerCapex" class="block text-sm font-medium text-gray-600 mt-2">投资 (万元)</label>
                            <input type="number" id="electricBoilerCapex" value="50" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <label for="electricSalvageRate" class="block text-xs font-medium text-gray-600 mt-2">残值率 (%)</label>
                            <input type="number" id="electricSalvageRate" value="5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-steam">
                            <div class="flex items-center mb-2">
                                <input type="checkbox" id="compare_steam" data-target="steam" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 comparison-toggle track-change" checked>
                                <label for="compare_steam" class="ml-2 block text-sm font-medium text-gray-700">管网蒸汽</label>
                            </div>
                            <label for="steamCapex" class="block text-sm font-medium text-gray-600 mt-2">投资 (万元)</label>
                            <input type="number" id="steamCapex" value="0" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                            <label for="steamSalvageRate" class="block text-xs font-medium text-gray-600 mt-2">残值率 (%)</label>
                            <input type="number" id="steamSalvageRate" value="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                    </div>
                </div>
            </section>
            
            <div id="standardModeSections" class="space-y-8">
                
                <!-- 3. 设备运行参数 -->
                <section class="bg-white p-6 rounded-xl shadow-md">
                    <h2 class="text-xl font-semibold mb-6 border-l-4 border-blue-500 pl-4">3. 设备运行参数</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-8">
                        <div>
                            <label for="hpCop" id="hpCopLabel" class="block text-sm font-medium text-gray-700 tooltip-container">
                                全年综合性能系数 (SPF)
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span class="tooltip-text"><b>定义 (VDI 4645):</b> SPF (Seasonal Performance Factor) 是指在<b>整个年度</b>内，工业热泵系统<b>总制热量</b>与<b>总耗电量</b>之比。<br><b>重要:</b> 此处的总耗电量<b>已包含</b>工业热泵主机、水泵、风机、电辅热等所有配套设备的耗电。</span>
                            </label>
                            <input type="number" id="hpCop" value="3.0" step="0.1" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-gas">
                            <label for="gasBoilerEfficiency" class="block text-sm font-medium text-gray-700 tooltip-container">
                                天然气锅炉效率 (%)
                                <span class="tooltip-text"><b>默认值: 92%</b><br>依据《工业锅炉能效限定值及能效等级》(GB 24500-2020)，为新型燃气锅炉的典型高效值。</span>
                            </label>
                            <input type="number" id="gasBoilerEfficiency" value="92" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-fuel">
                            <label for="fuelBoilerEfficiency" class="block text-sm font-medium text-gray-700 tooltip-container">
                                燃油锅炉效率 (%)
                                <span class="tooltip-text"><b>默认值: 90%</b><br>依据《工业锅炉能效限定值及能效等级》(GB 24500-2020)，为新型燃油锅炉的典型高效值。</span>
                            </label>
                            <input type="number" id="fuelBoilerEfficiency" value="90" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-coal">
                            <label for="coalBoilerEfficiency" class="block text-sm font-medium text-gray-700 tooltip-container">
                                燃煤锅炉效率 (%)
                                <span class="tooltip-text"><b>默认值: 80%</b><br>依据《工业锅炉能效限定值及能效等级》(GB 24500-2020)，为新型链条炉排燃煤锅炉的典型能效值。</span>
                            </label>
                            <input type="number" id="coalBoilerEfficiency" value="80" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-biomass">
                            <label for="biomassBoilerEfficiency" class="block text-sm font-medium text-gray-700 tooltip-container">
                                生物质锅炉效率 (%)
                                <span class="tooltip-text"><b>默认值: 85%</b><br>新型生物质锅炉的典型热效率，介于燃煤和燃气锅炉之间。</span>
                            </label>
                            <input type="number" id="biomassBoilerEfficiency" value="85" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-electric">
                            <label for="electricBoilerEfficiency" class="block text-sm font-medium text-gray-700 tooltip-container">
                                电锅炉效率 (%)
                                 <span class="tooltip-text"><b>默认值: 98%</b><br>电热转换效率的行业公认值，已考虑少量热损失。</span>
                            </label>
                            <input type="number" id="electricBoilerEfficiency" value="98" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-steam">
                            <label for="steamEfficiency" class="block text-sm font-medium text-gray-700 tooltip-container">
                                管网蒸汽效率 (%)
                                 <span class="tooltip-text"><b>默认值: 98%</b><br>指换热站或用户侧的换热效率，为高效板式换热器的典型值。</span>
                            </label>
                            <input type="number" id="steamEfficiency" value="98" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                    </div>
                </section>

                <!-- 4. 能源热值 -->
                <section class="bg-white p-6 rounded-xl shadow-md">
                     <h2 class="text-xl font-semibold mb-6 border-l-4 border-blue-500 pl-4">4. 能源热值</h2>
                     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6">
                         <div class="related-to-gas">
                            <label for="gasCalorificUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                天然气热值
                                 <span class="tooltip-text"><b>默认值: 35.57 MJ/m³</b><br>依据《天然气》（GB 17820-2018），为一类天然气的典型低位发热值。</span>
                            </label>
                            <select id="gasCalorificUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="MJ/m3" selected>MJ/m³</option>
                                <option value="kcal/m3">kcal/m³</option>
                                <option value="kWh/m3">kWh/m³</option>
                                <option value="GJ/m3">GJ/m³</option>
                            </select>
                            <input type="number" id="gasCalorific" data-base-value="35.57" value="35.57" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-fuel">
                            <label for="fuelCalorificUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                燃油热值
                                <span class="tooltip-text" id="fuelCalorificTooltip"><b>默认值: 42.6 MJ/kg</b><br>国标中0号柴油的典型低位发热量参考值。</span>
                            </label>
                            <select id="fuelCalorificUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="MJ/kg" selected>MJ/kg</option>
                                <option value="kcal/kg">kcal/kg</option>
                                <option value="GJ/t">GJ/t</option>
                                <option value="kWh/kg">kWh/kg</option>
                            </select>
                            <input type="number" id="fuelCalorific" data-base-value="42.6" value="42.6" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-coal">
                            <label for="coalCalorificUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                标准煤热值
                                <span class="tooltip-text"><b>默认值: 29.3 MJ/kg</b><br>标准煤的定义值，即每千克标准煤的发热量为7000大卡，折合约29.3MJ。</span>
                            </label>
                            <select id="coalCalorificUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="MJ/kg" selected>MJ/kg</option>
                                <option value="kcal/kg">kcal/kg</option>
                                <option value="GJ/t">GJ/t</option>
                                <option value="kWh/kg">kWh/kg</option>
                            </select>
                            <input type="number" id="coalCalorific" data-base-value="29.3" value="29.3" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-biomass">
                            <label for="biomassCalorificUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                生物质热值
                                <span class="tooltip-text"><b>默认值: 16.32 MJ/kg</b><br>相当于约 3900 kcal/kg，为常见木质颗粒等生物质成型燃料的典型低位发热值。</span>
                            </label>
                            <select id="biomassCalorificUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="MJ/kg" selected>MJ/kg</option>
                                <option value="kcal/kg">kcal/kg</option>
                                <option value="GJ/t">GJ/t</option>
                                <option value="kWh/kg">kWh/kg</option>
                            </select>
                            <input type="number" id="biomassCalorific" data-base-value="16.32" value="16.32" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-steam">
                            <label for="steamCalorificUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                管网蒸汽热值
                                 <span class="tooltip-text"><b>默认值: 700 kWh/吨</b><br>工程应用中常见的中低压工业饱和蒸汽热值(约2.5 GJ/吨)，如需按国标GB/T 2589-2020进行能耗核算，可取1086 kWh/吨。</span>
                            </label>
                             <select id="steamCalorificUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="kWh/t" selected>kWh/吨</option>
                                <option value="GJ/t">GJ/吨</option>
                            </select>
                            <input type="number" id="steamCalorific" data-base-value="700" value="700" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                     </div>
                </section>

                <!-- 5. 能源价格与排放因子 -->
                <section class="bg-white p-6 rounded-xl shadow-md">
                    <h2 class="text-xl font-semibold mb-6 border-l-4 border-blue-500 pl-4">5. 能源价格与排放因子</h2>
                    <div class="space-y-4">
                        <div class="flex flex-col sm:flex-row justify-between sm:items-center gap-4">
                            <div class="tooltip-container">
                                <label class="block text-sm font-medium text-gray-700">
                                    工业热泵电价时段
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                </label>
                                <span class="tooltip-text"><b>通用电价模式:</b><br>您可以自定义任意数量的电价时段（如峰、平、谷、尖），系统会根据您填写的“运行比例”自动计算加权平均电价。<br><b>示例:</b><br>1. <b>标准电价:</b> 只留一个时段, 比例 100%<br>2. <b>峰谷电价:</b> 添加3个时段, 比例分别填 30, 40, 30 (总和为100)</span>
                            </div>
                            <button id="addPriceTierBtn" type="button" class="flex-shrink-0 text-sm bg-green-100 text-green-700 font-semibold py-2 px-3 rounded-lg hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-300">
                                + 添加电价时段
                            </button>
                        </div>
                        <div id="priceTierError" class="hidden text-red-600 text-center font-bold p-2 bg-red-50 rounded-md"></div>
                        <div id="priceTiersContainer" class="space-y-3"></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6 mt-6 pt-6 border-t">
                        <div>
                             <div class="flex items-center mb-1 tooltip-container">
                                 <input type="checkbox" id="greenElectricityToggle" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 track-change">
                                <label for="greenElectricityToggle" class="ml-2 block text-sm font-medium text-gray-700">
                                    使用绿电
                                    <span class="tooltip-text"><b>默认值: 0.57 kgCO₂/kWh</b><br>数据来源：生态环境部《2022年度中国区域电网平均二氧化碳排放因子》，全国平均值。</span>
                                </label>
                            </div>
                            <select id="gridFactorUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="kgCO2/kWh" selected>kgCO₂/kWh</option>
                                <option value="tCO2/MWh">tCO₂/MWh</option>
                            </select>
                            <input type="number" id="gridFactor" data-base-value="0.57" value="0.57" step="0.01" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-gas">
                            <label for="gasPrice" class="block text-sm font-medium text-gray-700 tooltip-container">
                                天然气价 (元/m³)
                                <span class="tooltip-text"><b>默认值: 4.2 元/m³</b><br>参考国内主要城市非居民用天然气的平均价格。</span>
                            </label>
                            <input type="number" id="gasPrice" value="4.2" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-fuel">
                            <label for="fuelPrice" class="block text-sm font-medium text-gray-700 tooltip-container">
                                油价 (元/吨)
                                <span class="tooltip-text" id="fuelPriceTooltip"><b>默认值: 8900 元/吨</b><br>参考国内0号柴油市场价格及密度（约0.84kg/L）折算。</span>
                            </label>
                            <input type="number" id="fuelPrice" value="8900" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-coal">
                            <label for="coalPrice" class="block text-sm font-medium text-gray-700 tooltip-container">
                                煤价 (元/吨)
                                <span class="tooltip-text"><b>默认值: 1000 元/吨</b><br>参考国内动力煤（5500大卡）市场平均价格。</span>
                            </label>
                            <input type="number" id="coalPrice" value="1000" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-biomass">
                            <label for="biomassPrice" class="block text-sm font-medium text-gray-700 tooltip-container">
                                生物质价 (元/吨)
                                <span class="tooltip-text"><b>默认值: 850 元/吨</b><br>参考国内生物质成型燃料（如木质颗粒）的市场平均价格。</span>
                            </label>
                            <input type="number" id="biomassPrice" value="850" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-steam">
                            <label for="steamPrice" class="block text-sm font-medium text-gray-700 tooltip-container">
                                管网蒸汽价 (元/吨)
                                 <span class="tooltip-text"><b>默认值: 300 元/吨</b><br>参考国内主要城市集中供热管网蒸汽的市场价格。</span>
                            </label>
                            <input type="number" id="steamPrice" value="300" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-gas">
                            <label for="gasFactorUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                天然气因子
                                <span class="tooltip-text"><b>默认值: 1.97 kgCO₂/m³</b><br>参考《省级温室气体清单编制指南》推荐值，并结合常见天然气组分计算。</span>
                            </label>
                            <select id="gasFactorUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="kgCO2/m3" selected>kgCO₂/m³</option>
                                <option value="kgCO2/GJ">kgCO₂/GJ</option>
                            </select>
                            <input type="number" id="gasFactor" data-base-value="1.97" value="1.97" step="0.01" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-fuel">
                            <label for="fuelType" class="block text-sm font-medium text-gray-700 tooltip-container">
                                燃油种类与因子
                                <span class="tooltip-text" id="fuelFactorTooltip"><b>默认值: 3090 kgCO₂/吨</b><br>参考《省级温室气体清单编制指南》中柴油的排放因子。</span>
                            </label>
                            <select id="fuelType" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="diesel" selected>0号柴油</option>
                                <option value="heavy_oil">重油</option>
                                <option value_g="residual_oil">渣油</option>
                            </select>
                            <select id="fuelFactorUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="kgCO2/t" selected>kgCO₂/吨</option>
                                <option value="kgCO2/kg">kgCO₂/kg</option>
                                <option value="kgCO2/GJ">kgCO₂/GJ</option>
                            </select>
                            <input type="number" id="fuelFactor" data-base-value="3090" value="3090" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-coal">
                            <label for="coalFactorUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                燃煤因子
                                <span class="tooltip-text"><b>默认值: 2420 kgCO₂/吨</b><br>参考《省级温室气体清单编制指南》，适用于工业锅炉常用的烟煤或无烟煤。</span>
                            </label>
                             <select id="coalFactorUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="kgCO2/t" selected>kgCO₂/吨</option>
                                <option value="kgCO2/kg">kgCO₂/kg</option>
                                <option value="kgCO2/GJ">kgCO₂/GJ</option>
                            </select>
                            <input type="number" id="coalFactor" data-base-value="2420" value="2420" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                        <div class="related-to-biomass">
                            <label for="biomassFactorUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                生物质因子
                                <span class="tooltip-text"><b>默认值: 0 kgCO₂/吨</b><br>依据《省级温室气体清单编制指南》等权威标准，生物质燃料燃烧排放的CO₂视为“碳中性”（即不计入化石能源排放），故净排放因子计为0。</span>
                            </label>
                             <select id="biomassFactorUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="kgCO2/t" selected>kgCO₂/吨</option>
                                <option value="kgCO2/kg">kgCO₂/kg</option>
                                <option value="kgCO2/GJ">kgCO₂/GJ</option>
                            </select>
                            <input type="number" id="biomassFactor" data-base-value="0" value="0" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <div class="related-to-steam">
                            <label for="steamFactorUnit" class="block text-sm font-medium text-gray-700 tooltip-container">
                                管网蒸汽因子
                                 <span class="tooltip-text"><b>默认值: 0.35 kgCO₂/kWh</b><br>行业常用参考值，基于以燃煤热电联产为主的热源，并考虑热电分配。</span>
                            </label>
                             <select id="steamFactorUnit" class="mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 track-change">
                                <option value="kgCO2/kWh" selected>kgCO₂/kWh</option>
                                <option value="tCO2/MWh">tCO₂/MWh</option>
                                <option value="kgCO2/GJ">kgCO₂/GJ</option>
                            </select>
                            <input type="number" id="steamFactor" data-base-value="0.35" value="0.35" step="0.001" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                        </div>
                         <!-- V13.0: This is a placeholder for electric boiler factor, which is same as grid, so no separate input needed. -->
                        <div class="related-to-electric hidden"></div>
                    </div>
                </section>

                <!-- 6. 年度运维 (O&M) 成本 -->
                <section class="bg-white p-6 rounded-xl shadow-md">
                     <h2 class="text-xl font-semibold mb-6 border-l-4 border-blue-500 pl-4">6. 年度运维 (O&M) 成本 (万元/年)</h2>
                     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-6">
                         <div>
                            <label for="hpOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                工业热泵系统
                                <span class="tooltip-text"><b>默认值: 2.5 万元/年</b><br>含人工及维保物料费。估算: 0.5万人工 + 1%*200万投资维保。</span>
                             </label>
                            <input type="number" id="hpOpexCost" value="2.5" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                         </div>
                         <div class="related-to-gas">
                            <label for="gasOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                天然气锅炉
                                <span class="tooltip-text"><b>默认值: 1.8 万元/年</b><br>含人工及维保物料费。估算: 1万人工 + 1%*80万投资维保。</span>
                             </label>
                            <input type="number" id="gasOpexCost" value="1.8" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                         </div>
                         <div class="related-to-fuel">
                            <label for="fuelOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                燃油锅炉
                                <span class="tooltip-text"><b>默认值: 1.9 万元/年</b><br>含人工及维保物料费。估算: 1.2万人工 + 1%*70万投资维保。</span>
                             </label>
                            <input type="number" id="fuelOpexCost" value="1.9" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                         </div>
                          <div class="related-to-coal">
                            <label for="coalOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                燃煤锅炉
                                <span class="tooltip-text"><b>默认值: 6.8 万元/年</b><br>含人工及维保物料费。估算: 5万人工 + 3%*60万投资维保。</span>
                             </label>
                            <input type="number" id="coalOpexCost" value="6.8" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                         </div>
                         <div class="related-to-biomass">
                            <label for="biomassOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                生物质锅炉
                                <span class="tooltip-text"><b>默认值: 6.3 万元/年</b><br>含人工及维保物料费。估算: 4万人工 + 3%*75万投资维保。</span>
                             </label>
                            <input type="number" id="biomassOpexCost" value="6.3" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                         </div>
                         <div class="related-to-electric">
                            <label for="electricOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                电锅炉
                                <span class="tooltip-text"><b>默认值: 0.4 万元/年</b><br>含人工及维保物料费。估算: 0.2万人工 + 0.4%*50万投资维保。</span>
                             </label>
                            <input type="number" id="electricOpexCost" value="0.4" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                         </div>
                         <div class="related-to-steam">
                            <label for="steamOpexCost" class="block text-sm font-medium text-gray-700 tooltip-container">
                                管网蒸汽 (运维)
                                <span class="tooltip-text"><b>默认值: 0 万元/年</b><br>假设用户侧运维成本已计入蒸汽单价或可忽略不计。</span>
                             </label>
                            <input type="number" id="steamOpexCost" value="0" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                         </div>
                     </div>
                 </section>
            </div> 
            
            <!-- 7. 财务分析参数 -->
            <section id="lccParamsContainer" class="bg-white p-6 rounded-xl shadow-md">
                <div class="flex items-center mb-6">
                    <h2 id="section7Title" class="text-xl font-semibold border-l-4 border-blue-500 pl-4">7. 财务分析参数</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div>
                        <label for="lccYears" class="block text-sm font-medium text-gray-700 tooltip-container">
                            经济分析年限 (年)
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            <span class="tooltip-text"><b>我们打算算多少年的总账？</b><br><br>通常取设备的主要经济寿命（比如15年）。这个年限越长，初始投资(CAPEX)的影响就越小，LCC 和 PBP 的计算就越偏向于“运营成本”。</span>
                        </label>
                        <input type="number" id="lccYears" value="15" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                    </div>
                    <div>
                        <label for="discountRate" class="block text-sm font-medium text-gray-700 tooltip-container">
                            折现率 (基准收益率, %)
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-text-bottom ml-1 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            <span class="tooltip-text"><b>这是最重要的“及格线”</b>。<br><br>您可以把它理解为“我们对这个项目最低的年化收益要求”。如果项目连这个数都达不到（比如 8%），那还不如把钱存银行或投别的。<br><br><b>IRR 必须 > 这个数</b>，项目才算优秀。</span>
                        </label>
                        <input type="number" id="discountRate" value="8" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                    </div>
                    <div>
                        <label for="energyInflationRate" class="block text-sm font-medium text-gray-700 tooltip-container">
                            能源价格年均涨幅 (%)
                            <span class="tooltip-text"><b>默认值: 3 %</b><br>预测的能源（电、气、油、煤等）价格年均增长率。</span>
                        </label>
                        <input type="number" id="energyInflationRate" value="3" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                    </div>
                    <div>
                        <label for="opexInflationRate" class="block text-sm font-medium text-gray-700 tooltip-container">
                            运维成本年均涨幅 (%)
                            <span class="tooltip-text"><b>默认值: 5 %</b><br>预测的O&M成本（人工+维保）年均增长率。</span>
                        </label>
                        <input type="number" id="opexInflationRate" value="5" step="0.1" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 default-param track-change">
                    </div>
                </div>
            </section>

            <div id="stale-results-notice" class="hidden text-red-600 text-center font-bold my-4">参数已更改，请重新计算！</div>

            <button id="calculateBtn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-300 text-lg">
                开始计算分析
            </button>

            <div class="mt-4 flex flex-col sm:flex-row items-center justify-center gap-4">
                <div class="flex items-center">
                    <input type="checkbox" id="enableScenarioComparison" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 track-change">
                    <label for="enableScenarioComparison" class="ml-2 block text-sm font-medium text-gray-700">启用多方案对比</label>
                </div>
                <button id="saveScenarioBtn" class="text-sm bg-gray-400 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-300 hidden cursor-not-allowed" disabled>
                    暂存当前工业热泵方案 (请先计算)
                </button>
            </div>

            <!-- 结果容器 -->
            <div id="results-container" class="mt-8">
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h2 id="results-title" class="text-2xl font-semibold mb-6 text-center">分析结果</h2>
                    <div id="results-placeholder" class="text-center text-gray-500 py-8">
                        <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                        </svg>
                        <p class="mt-2">请填写上方参数并点击计算</p>
                    </div>
                    <div id="results-content" class="hidden space-y-6"></div>
                </div>
            </div>

            <!-- 多方案对比容器 -->
            <div id="scenario-comparison-container" class="mt-8 bg-white p-6 rounded-xl shadow-md hidden"></div>

        </main>

        <footer class="text-center py-6 text-sm text-gray-500 border-t mt-12">
            <p>本程序已尽力确保正确，但不承担相关法律责任，App bug 请联系荆炎荣 15280122625。</p>
            <p class="mt-1">注：全寿命周期成本(LCC)与ROI计算基于净现值(NPV)法，符合《建设项目经济评价方法与参数》相关规定。</p>
        </footer>

        <!-- 确认模态框 -->
        <div id="confirm-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-40">
            <div class="relative top-20 mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white">
                <div class="mt-3 text-center">
                    <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100">
                        <svg class="h-6 w-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                    </div>
                    <h3 id="confirm-modal-title" class="text-lg leading-6 font-medium text-gray-900 mt-2">确认操作</h3>
                    <div class="mt-2 px-7 py-3">
                        <p id="confirm-modal-message" class="text-sm text-gray-500">确定要执行此操作吗？</p>
                    </div>
                    <div class="items-center px-4 py-3 space-x-4">
                        <button id="confirm-modal-cancel-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 focus:outline-none">
                            取消
                        </button>
                        <button id="confirm-modal-ok-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none">
                            确认
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div> 
    

    <!-- 打印报告容器 -->
    <div id="print-report-container" class="print-only"></div>
    
</body>
</html>